generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:../prod.db"
}

model course {
  code      String      @id
  title     String
  credits   Int
  result    result[]
  result_pg result_pg[]
}

model result {
  id           Int     @id @default(autoincrement())
  rollno       String
  code         String
  grade        Int
  grade_letter String
  semester     Int
  gp           Int
  course       course  @relation(fields: [code], references: [code])
  student      student @relation(fields: [rollno], references: [rollno])

  @@unique([rollno, code], map: "sqlite_autoindex_result_1")
}

model result_pg {
  id           Int     @id @default(autoincrement())
  rollno       String
  code         String
  grade        Int
  grade_letter String
  semester     Int
  course       course  @relation(fields: [code], references: [code])
  student      student @relation(fields: [rollno], references: [rollno])

  @@unique([rollno, code], map: "sqlite_autoindex_result_pg_1")
}

model student {
  rollno       String      @id
  name         String
  fathers_name String
  branch_code  String
  branch       branch      @relation(fields: [branch_code], references: [code], onDelete: Cascade)
  batch        Int
  summary      summary     @relation(fields: [rollno], references: [rollno])
  rank         rank        @relation(fields: [rollno], references: [rollno])
  result       result[]
  result_pg    result_pg[]
}

model sem_summary {
  id         Int    @id @default(autoincrement())
  rollno     String
  semester   Int
  sgpi       String
  cgpi       String
  sgpi_total Int
  cgpi_total Int

  @@unique([rollno, semester])
}

model summary {
  rollno     String   @id
  semester   Int
  sgpi       String
  cgpi       String
  sgpi_total Int
  cgpi_total Int
  student    student?
}

model rank {
  rollno            String   @id
  class_rank_sgpi   Int      @default(0)
  class_rank_cgpi   Int      @default(0)
  year_rank_sgpi    Int      @default(0)
  year_rank_cgpi    Int      @default(0)
  college_rank_sgpi Int      @default(0)
  college_rank_cgpi Int      @default(0)
  student           student?
}

model branch {
  code    String    @id
  name    String
  student student[]
}
